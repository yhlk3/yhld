<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.module.mapper.CategoryMapper">
    <insert id="insert"
            useGeneratedKeys="true"
            keyProperty="id"
            parameterType="com.example.module.entity.Category">
        insert into category(
        <if test="category.name != null and category.name != ''">name,</if>
        <if test="category.image != null and category.image != ''">image,</if>
        <if test="category.createTime != null">create_time,</if>
        <if test="category.updateTime != null">update_time,</if>
        is_deleted
        )values(
        <if test="category.name != null and category.name!= ''">#{category.name},</if>
        <if test="category.image != null and category.image!= ''">#{category.image},</if>
        <if test="category.createTime != null">#{category.create_time},</if>
        <if test="category.updateTime != null">#{category.update_time},</if>
        #{isDeleted}
        )
    </insert>

    <!-- 更新操作 -->
    <update id="update" parameterType="com.example.module.entity.Category">
        UPDATE category
        <set>
            <if test="category.name != null and category.name != ''">
                name=#{category.name},
            </if>
            <if test="category.image != null and category.image != ''">
                image=#{category.image},
            </if>
            <if test="category.createTime != null">
                create_time=#{category.createTime},
            </if>
            <if test="category.updateTime != null">
                update_time=#{category.updateTime},
            </if>
            <if test="category.isDeleted != null">
                is_deleted=#{category.isDeleted},
            </if>
        </set>
        WHERE id= #{category.id}
    </update>

    <select id="getCategoriesByIds" resultType="com.example.module.entity.Category">
        SELECT * FROM category
        WHERE is_deleted = 0
        <if test="ids != null and ids != ''">
            AND id IN (${ids})
        </if>
    </select>
</mapper>