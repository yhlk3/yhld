<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.module.sms.mapper.SmsMapper">

    <!-- 插入短信记录（支持字段动态判断） -->
    <insert id="insert" parameterType="com.example.module.sms.entity.SmsRecord"
            useGeneratedKeys="true" keyProperty="sms.id">
        INSERT INTO sms (
        <if test="sms.phone != null and sms.phone != ''">phone,</if>
        <if test="sms.content != null and sms.content != ''">content,</if>
        <if test="sms.sendTime != null">send_time,</if>
        <if test="sms.status != null">is_status</if>
        ) VALUES (
        <if test="sms.phone != null and sms.phone != ''">#{sms.phone},</if>
        <if test="sms.content != null and sms.content != ''">#{sms.content},</if>
        <if test="sms.sendTime != null">#{sms.sendTime},</if>
        <if test="sms.status != null">#{sms.status}</if>
        )
    </insert>

    <!-- 更新短信记录（动态字段更新） -->
    <update id="update" parameterType="com.example.module.sms.entity.SmsRecord">
        UPDATE sms
        <set>
            <if test="sms.phone != null and sms.phone != ''">phone = #{sms.phone},</if>
            <if test="sms.content != null and sms.content != ''">content = #{sms.content},</if>
            <if test="sms.sendTime != null">send_time = #{sms.sendTime},</if>
            <if test="sms.status != null">is_deleted = #{sms.status}</if>
        </set>
        WHERE id = #{sms.id}
    </update>

</mapper>
